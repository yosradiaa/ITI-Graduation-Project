<h2>User Management</h2>

<table class="table mt-4">
  <thead>
    <tr>
      <th>First Name</th>
      <th>Last Name</th>
      <th>Email</th>
      <th>Address</th>
      <th>Mobile</th>
      <th>Password</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let user of users" [id]="'user_' + user.id">
      <!-- <td>{{ user.id }}</td> -->
      <td>{{ user.firstName }}</td>
      <td>{{ user.lastName }}</td>
      <td>{{ user.email }}</td>
      <td>{{ user.address }}</td>
      <td>{{ user.mobile }}</td>
      <td>{{ user.password }}</td>
      <td>
        <button (click)="editUser(user)" class="btn btn-success btn-sm">Edit</button>
        <button (click)="deleteUser(user.id)" class="btn btn-danger btn-sm">Delete</button>
      </td>
    </tr>
  </tbody>
</table>

<div *ngIf="showEditUserForm">
  <h3>Edit User</h3>
  <form [formGroup]="editUserForm" (ngSubmit)="saveUserChanges()">
    <input type="hidden" formControlName="id">
    <div class="mb-3">
      <label for="editFirstName" class="form-label">First Name</label>
      <input type="text" class="form-control" id="editFirstName" formControlName="firstName">
      <div *ngIf="editUserForm.get('firstName')?.touched && editUserForm.get('firstName')?.hasError('required')"
        class="text-danger">
        First Name is required.
      </div>
    </div>

    <div class="mb-3">
      <label for="editLastName" class="form-label">Last Name</label>
      <input type="text" class="form-control" id="editLastName" formControlName="lastName">
      <div *ngIf="editUserForm.get('lastName')?.touched && editUserForm.get('lastName')?.hasError('required')"
        class="text-danger">
        Last Name is required.
      </div>
    </div>

    <div class="mb-3">
      <label for="editEmail" class="form-label">Email</label>
      <input type="email" class="form-control" id="editEmail" formControlName="email">
      <div *ngIf="editUserForm.get('email')?.touched && editUserForm.get('email')?.hasError('required')"
        class="text-danger">
        Email is required.
      </div>
      <div *ngIf="editUserForm.get('email')?.touched && editUserForm.get('email')?.hasError('email')"
        class="text-danger">
        Please enter a valid email address.
      </div>
    </div>

    <div class="mb-3">
      <label for="editAddress" class="form-label">Address</label>
      <input type="text" class="form-control" id="editAddress" formControlName="address">
      <div *ngIf="editUserForm.get('address')?.touched && editUserForm.get('address')?.hasError('required')"
        class="text-danger">
        Address is required.
      </div>
    </div>

    <div class="mb-3">
      <label for="editMobile" class="form-label">Mobile</label>
      <input type="text" class="form-control" id="editMobile" formControlName="mobile">
      <div *ngIf="editUserForm.get('mobile')?.touched && editUserForm.get('mobile')?.hasError('required')"
        class="text-danger">
        Mobile phone number is required.
      </div>
      <div *ngIf="editUserForm.get('mobile')?.touched && editUserForm.get('mobile')?.hasError('pattern')"
        class="text-danger">
        Mobile phone number must match the pattern (e.g.,"010", "011", "012" or "010" and then 8 digits).
      </div>
    </div>

    <div class="mb-3">
      <label for="editPassword" class="form-label">Password</label>
      <input type="password" class="form-control" id="editPassword" formControlName="password">
      <div *ngIf="editUserForm.get('password')?.touched && editUserForm.get('password')?.hasError('required')"
        class="text-danger">
        Password is required.
      </div>
    </div>
<div class="w-100 d-flex">
    <button type="submit" class="btn btn-dark w-50">Save Changes</button>
    <button type="button" class="btn btn-secondary w-50" (click)="cancelEdit()">Cancel</button>
  </div>
  </form>
</div>

<br><br>
<button class="btn btn-secondary mb-3 w-100" (click)="toggleAddUserForm()">Add User</button>


<div *ngIf="showAddUserForm" class="my-5">
  <h3>Add User</h3>
  <hr>
  <form [formGroup]="addUserForm" (ngSubmit)="addUser()">

    <div class="mb-3">
      <label for="firstName" class="form-label">First Name</label>
      <input type="text" class="form-control" id="firstName" formControlName="firstName">
      <div *ngIf="addUserForm.get('firstName')?.touched && addUserForm.get('firstName')?.hasError('required')"
        class="text-danger">
        First Name is required.
      </div>
    </div>

    <div class="mb-3">
      <label for="lastName" class="form-label">Last Name</label>
      <input type="text" class="form-control" id="lastName" formControlName="lastName">
      <div *ngIf="addUserForm.get('lastName')?.touched && addUserForm.get('lastName')?.hasError('required')"
        class="text-danger">
        Last Name is required.
      </div>
    </div>

    <div class="mb-3">
      <label for="email" class="form-label">Email</label>
      <input type="email" class="form-control" id="email" formControlName="email">
      <div *ngIf="addUserForm.get('email')?.touched && addUserForm.get('email')?.hasError('required')"
        class="text-danger">
        Email is required.
      </div>
      <div *ngIf="addUserForm.get('email')?.touched && addUserForm.get('email')?.hasError('email')" class="text-danger">
        Please enter a valid email address.
      </div>
    </div>

    <div class="mb-3">
      <label for="address" class="form-label">Address</label>
      <input type="text" class="form-control" id="address" formControlName="address">
      <div *ngIf="addUserForm.get('address')?.touched && addUserForm.get('address')?.hasError('required')"
        class="text-danger">
        Address is required.
      </div>
    </div>


    <div class="mb-3">
      <label for="addUserForm" class="form-label">Mobile</label>
      <input type="text" class="form-control" id="editMobile" formControlName="mobile">
      <div *ngIf="addUserForm.get('mobile')?.touched && addUserForm.get('mobile')?.hasError('required')"
        class="text-danger">
        Mobile phone number is required.
      </div>
      <div *ngIf="addUserForm.get('mobile')?.touched && addUserForm.get('mobile')?.hasError('pattern')"
        class="text-danger">
        Mobile phone number must match the pattern (e.g.,"010", "011", "012" or "010" and then 8 digits).
      </div>
    </div>

    <div class="mb-3">
      <label for="password" class="form-label">Password</label>
      <input type="password" class="form-control" id="password" formControlName="password">
      <div *ngIf="addUserForm.get('password')?.touched && addUserForm.get('password')?.hasError('required')"
        class="text-danger">
        Paswword is required.
      </div>
    </div>
    <div class="d-flex mt-3 w-100">
    <button type="submit" class="btn btn-dark w-50">Add User</button>
    <button type="button" class="btn btn-secondary w-50" (click)="cancelAddUser()">Cancel</button>
  </div>
  </form>
</div>

